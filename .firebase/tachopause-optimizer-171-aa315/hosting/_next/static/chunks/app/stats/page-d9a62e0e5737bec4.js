(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2740],{3862:function(e,t,r){Promise.resolve().then(r.bind(r,7137))},7137:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var n=r(7437),a=r(2265),s=r(8444),i=r(4171),c=r(2381),l=r(9820),d=r(6349),o=r(9677),u=r(2514),m=r(7240),f=r(4438);let x=e=>{let{type:t}=e;return({WORKDAY_START:(0,n.jsx)(i.P.Play,{className:"text-green-500"}),WORKDAY_END:(0,n.jsx)(i.P.close,{className:"text-red-500"}),MOVEMENT_START:(0,n.jsx)(i.P.arrowRight,{className:"text-blue-500"}),MOVEMENT_STOP:(0,n.jsx)(i.P.MapPin,{className:"text-orange-500"}),DRIVING_PAUSE_START:(0,n.jsx)(i.P.Pause,{className:"text-purple-500"}),DRIVING_PAUSE_END:(0,n.jsx)(i.P.Pause,{className:"text-purple-500 opacity-50"})})[t]||null},p=e=>{let{event:t}=e;return(0,n.jsx)("p",{children:{WORKDAY_START:"Inicio de la jornada",WORKDAY_END:"Fin de la jornada",MOVEMENT_START:"Inicio de movimiento",MOVEMENT_STOP:"Veh\xedculo detenido",DRIVING_PAUSE_START:"Inicio de pausa de conducci\xf3n",DRIVING_PAUSE_END:"Fin de pausa de conducci\xf3n"}[t.type]})};function h(){var e;let{user:t}=(0,d.aC)(),[r,h]=(0,a.useState)([]),[g,b]=(0,a.useState)(null),[j,N]=(0,a.useState)([]),[v,y]=(0,a.useState)(!0),[Z,w]=(0,a.useState)(!1),[T,P]=(0,a.useState)(!1);(0,a.useEffect)(()=>{t&&(y(!0),(0,o.lu)(t.uid).then(e=>{h(e),e.length>0&&E(e[0])}).catch(e=>f.Am.error("Error al cargar las jornadas.")).finally(()=>y(!1)))},[t]);let E=e=>{b(e),w(!0),(0,o.Tt)(e.userId,e.id).then(N).catch(t=>f.Am.error("Error al cargar los eventos del d\xeda ".concat(e.id,"."))).finally(()=>w(!1))},C=async()=>{if(t&&g){P(!0),f.Am.info("Generando el archivo CSV...");try{let e=await (0,o.bT)(t.uid,g.id),r=new Blob([e],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),a=URL.createObjectURL(r);n.setAttribute("href",a),n.setAttribute("download","jornada-".concat(g.id,".csv")),document.body.appendChild(n),n.click(),document.body.removeChild(n),f.Am.success("La exportaci\xf3n se ha completado.")}catch(e){console.error("Export failed:",e),f.Am.error("No se pudo exportar la jornada.")}finally{P(!1)}}};return(0,n.jsxs)("div",{className:"flex min-h-dvh bg-background",children:[(0,n.jsx)(s._,{}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,n.jsxs)("header",{className:"bg-background/95 backdrop-blur-sm supports-[backdrop-filter]:bg-background/60 sticky top-0 z-10 flex h-16 items-center justify-between border-b px-4 sm:px-6",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(i.P.BarChart,{className:"h-6 w-6 text-primary"}),(0,n.jsx)("h1",{className:"text-lg font-bold",children:"Historial de Jornadas"})]}),(0,n.jsxs)(c.z,{onClick:C,disabled:!g||T,children:[T?(0,n.jsx)(i.P.spinner,{className:"animate-spin h-4 w-4 mr-2"}):(0,n.jsx)(i.P.share,{className:"h-4 w-4 mr-2"}),"Exportar a CSV"]})]}),(0,n.jsxs)("main",{className:"flex-1 p-4 sm:p-6 md:grid md:grid-cols-3 md:gap-6 lg:grid-cols-4",children:[(0,n.jsxs)(l.Zb,{className:"md:col-span-1 lg:col-span-1 mb-6 md:mb-0 h-fit sticky top-24",children:[(0,n.jsxs)(l.Ol,{children:[(0,n.jsx)(l.ll,{children:"Jornadas Recientes"}),(0,n.jsx)(l.SZ,{children:"Selecciona un d\xeda para ver sus detalles."})]}),(0,n.jsxs)(l.aY,{className:"flex flex-col gap-2 p-2",children:[v&&(0,n.jsx)("div",{className:"p-4 text-center",children:(0,n.jsx)(i.P.spinner,{className:"animate-spin h-6 w-6 mx-auto"})}),!v&&r.map(e=>(0,n.jsx)(c.z,{variant:(null==g?void 0:g.id)===e.id?"secondary":"ghost",onClick:()=>E(e),className:"w-full justify-start",children:(0,u.WU)(new Date(e.id),"EEEE, d 'de' MMMM",{locale:m.es})},e.id)),!v&&0===r.length&&(0,n.jsx)("p",{className:"p-4 text-sm text-center text-muted-foreground",children:"No se han encontrado jornadas."})]})]}),(0,n.jsxs)("div",{className:"md:col-span-2 lg:col-span-3",children:[!g&&!v&&(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center text-center py-16",children:[(0,n.jsx)(i.P.History,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"Selecciona una jornada de la lista para ver los detalles."})]}),g&&(0,n.jsxs)(l.Zb,{children:[(0,n.jsxs)(l.Ol,{children:[(0,n.jsxs)(l.ll,{children:["Detalles del ",(0,u.WU)(new Date(g.id),"d 'de' MMMM, yyyy",{locale:m.es})]}),(0,n.jsxs)("div",{className:"text-sm text-muted-foreground flex flex-wrap gap-x-4 gap-y-1 pt-1",children:[(0,n.jsxs)("span",{children:[(0,n.jsx)("strong",{className:"font-medium",children:"Inicio:"})," ",(0,u.WU)(new Date(g.startTime),"HH:mm")]}),(0,n.jsxs)("span",{children:[(0,n.jsx)("strong",{className:"font-medium",children:"Fin:"})," ",g.endTime?(0,u.WU)(new Date(g.endTime),"HH:mm"):"En curso"]}),(0,n.jsxs)("span",{className:"text-primary font-bold",children:[(0,n.jsx)("strong",{className:"font-medium",children:"Conducci\xf3n:"})," ",(e=g.totalDrivingTimeSeconds,"".concat(Math.floor(e/3600),"h ").concat(Math.floor(e%3600/60),"m"))]})]})]}),(0,n.jsxs)(l.aY,{children:[(0,n.jsx)("h3",{className:"font-semibold mb-3",children:"Cronolog\xeda de Eventos"}),Z&&(0,n.jsx)("div",{className:"py-8 text-center",children:(0,n.jsx)(i.P.spinner,{className:"animate-spin h-6 w-6 mx-auto"})}),!Z&&j.length>0&&(0,n.jsx)("ul",{className:"space-y-4",children:j.map(e=>(0,n.jsxs)("li",{className:"flex items-center gap-4",children:[(0,n.jsx)("div",{className:"w-8 h-8 rounded-full bg-secondary flex items-center justify-center",children:(0,n.jsx)(x,{type:e.type})}),(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)(p,{event:e})}),(0,n.jsx)("time",{className:"text-sm text-muted-foreground",children:(0,u.WU)(new Date(e.timestamp),"HH:mm:ss")})]},e.id))}),!Z&&0===j.length&&(0,n.jsx)("p",{className:"text-center text-muted-foreground py-8",children:"No hay eventos registrados para este d\xeda."})]})]})]})]})]})]})}},9677:function(e,t,r){"use strict";r.d(t,{AT:function(){return s},Mt:function(){return i},Tt:function(){return d},bT:function(){return a},eA:function(){return c},lu:function(){return l}}),r(3079);var n=r(2119),a=(0,n.$)("f7ca9c6a348f4946ab314160b9756adbc21e56be"),s=(0,n.$)("532e0f308f18c5302be6ae2d1083f4251b745ea9"),i=(0,n.$)("eaafc0283e2bd901bd90e938bb7a68e5806d44d8"),c=(0,n.$)("3527d2b2120a24df8a81be3cd5f440d8c41666bc"),l=(0,n.$)("400a8583cae1b772fec84c192a3eefbf320f6511"),d=(0,n.$)("5ac2d36a911a85ae45d208e2a9fb0b0cf0043b37")},4171:function(e,t,r){"use strict";r.d(t,{P:function(){return G}});var n=r(7437),a=r(3315),s=r(2489),i=r(2451),c=r(407),l=r(7413),d=r(8736),o=r(9658),u=r(3113),m=r(8728),f=r(8226),x=r(1533),p=r(9397),h=r(6865),g=r(2369),b=r(6858),j=r(5685),N=r(2351),v=r(2583),y=r(7226),Z=r(7716),w=r(9090),T=r(3276),P=r(340),E=r(476),C=r(9525),R=r(3618),S=r(3774),_=r(4794),A=r(3041),M=r(5621),k=r(6818),D=r(1769),O=r(3327),I=r(7718),U=r(5954),V=r(2048),W=r(8406),H=r(4394),z=r(8617),Y=r(9227),B=r(8906);let G={logo:a.Z,close:s.Z,spinner:a.Z,chevronLeft:i.Z,chevronRight:c.Z,trash:l.Z,post:d.Z,page:o.Z,media:u.Z,settings:m.Z,billing:f.Z,ellipsis:x.Z,add:p.Z,warning:h.Z,user:g.Z,arrowRight:b.Z,help:j.Z,twitter:N.Z,sun:v.Z,moon:y.Z,laptop:Z.Z,gitHub:e=>{let{...t}=e;return(0,n.jsx)("svg",{viewBox:"0 0 24 24",...t,children:(0,n.jsx)("path",{d:"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"})})},Login:w.Z,Play:T.Z,Truck:P.Z,Speedometer:E.Z,Wrench:C.Z,Calculator:R.Z,MapPin:S.Z,Package:_.Z,Phone:A.Z,History:M.Z,BarChart:k.Z,BookOpen:D.Z,FileText:d.Z,Award:O.Z,Milestone:I.Z,Timer:U.Z,Map:V.Z,Route:W.Z,share:H.Z,Premium:z.Z,Pause:Y.Z,Gauge:E.Z,Shield:B.Z}},2381:function(e,t,r){"use strict";r.d(t,{d:function(){return l},z:function(){return d}});var n=r(7437),a=r(2265),s=r(7053),i=r(535),c=r(3448);let l=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:r,variant:a,size:i,asChild:d=!1,...o}=e,u=d?s.g7:"button";return(0,n.jsx)(u,{className:(0,c.cn)(l({variant:a,size:i,className:r})),ref:t,...o})});d.displayName="Button"},9820:function(e,t,r){"use strict";r.d(t,{Ol:function(){return c},SZ:function(){return d},Zb:function(){return i},aY:function(){return o},eW:function(){return u},ll:function(){return l}});var n=r(7437),a=r(2265),s=r(3448);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});i.displayName="Card";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",r),...a})});c.displayName="CardHeader";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});l.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",r),...a})});d.displayName="CardDescription";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",r),...a})});o.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",r),...a})});u.displayName="CardFooter"},9140:function(e,t,r){"use strict";r.d(t,{O:function(){return s}});var n=r(7437),a=r(3448);function s(e){let{className:t,...r}=e;return(0,n.jsx)("div",{className:(0,a.cn)("animate-pulse rounded-md bg-muted",t),...r})}},323:function(e,t,r){"use strict";r.d(t,{CU:function(){return n.CU},Km:function(){return n.Km},T3:function(){return a.T3},aC:function(){return a.aC}}),r(738),r(3301),r(5978);var n=r(641),a=r(6349);r(257)},29:function(e,t,r){"use strict";r.d(t,{g:function(){return s}});var n=r(6349),a=r(9115);function s(){let{isPremium:e}=(0,n.aC)(),{isActive:t}=(0,a.N)();return{isPremium:e||t}}},3448:function(e,t,r){"use strict";r.d(t,{cn:function(){return s}});var n=r(1994),a=r(3335);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,n.W)(t))}}},function(e){e.O(0,[4358,139,9555,6137,611,2661,248,7283,1003,7648,9470,8782,4539,6349,8444,2971,2117,1744],function(){return e(e.s=3862)}),_N_E=e.O()}]);