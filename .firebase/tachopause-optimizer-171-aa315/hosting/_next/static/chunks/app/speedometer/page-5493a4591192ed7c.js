(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8918],{4823:function(e,t,a){Promise.resolve().then(a.bind(a,6489))},2119:function(e,t,a){"use strict";Object.defineProperty(t,"$",{enumerable:!0,get:function(){return r}});let s=a(3079);function r(e){let{createServerReference:t}=a(6671);return t(e,s.callServer)}},6489:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var s=a(7437),r=a(2265),l=a(9820),n=a(2381),c=a(4171),i=a(3340),o=a(2412),d=a(3448),u=a(7590),m=a(6586),x=a(323);let h=e=>{let t=Math.floor(e/1e3);return"".concat(String(Math.floor(t/3600)).padStart(2,"0"),":").concat(String(Math.floor(t%3600/60)).padStart(2,"0"),":").concat(String(t%60).padStart(2,"0"))};function f(){let[e,t]=(0,r.useState)(0),[a,f]=(0,r.useState)(!1),[p,g]=(0,r.useState)(null),j=(0,r.useRef)(null),{toast:N}=(0,i.pm)(),[b,v]=(0,r.useState)(0),[S,w]=(0,r.useState)(0),[M,P]=(0,r.useState)(0),[k,y]=(0,r.useState)(0),[I,E]=(0,r.useState)(null),D=(0,r.useRef)(null),G=(0,r.useRef)([]),{user:O}=(0,x.aC)(),A=(0,x.CU)(),{updateAchievementProgress:_,incrementAchievementProgress:R}=(0,u.R)(),W=e=>{let a=e.coords.speed,s=a?Math.round(3.6*a):0;if(t(s),g(null),s>b&&(v(s),_("speeder",s),_("supersonic",s)),D.current){let t=M+function(e,t,a,s){let r=(a-e)*Math.PI/180,l=(s-t)*Math.PI/180,n=Math.sin(r/2)*Math.sin(r/2)+Math.cos(e*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(l/2)*Math.sin(l/2);return 2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n))*6371e3}(D.current.coords.latitude,D.current.coords.longitude,e.coords.latitude,e.coords.longitude);P(t),_("marathoner",t/1e3)}D.current=e,s>0&&(G.current.push(s),w(Math.round(G.current.reduce((e,t)=>e+t,0)/G.current.length)))},V=e=>{let t="Error desconocido al obtener la ubicaci\xf3n.";switch(e.code){case e.PERMISSION_DENIED:t="Permiso de geolocalizaci\xf3n denegado.";break;case e.POSITION_UNAVAILABLE:t="Informaci\xf3n de ubicaci\xf3n no disponible.";break;case e.TIMEOUT:t="Se agot\xf3 el tiempo de espera para obtener la ubicaci\xf3n."}g(t),N({title:"Error de GPS",description:t,variant:"destructive"}),L(!1)},z=()=>{t(0),v(0),w(0),P(0),y(0),E(null),D.current=null,G.current=[]},C=()=>{if(!navigator.geolocation){g("Geolocalizaci\xf3n no es compatible con este navegador."),N({title:"Error de compatibilidad",description:"La geolocalizaci\xf3n no es compatible con este navegador.",variant:"destructive"});return}z(),f(!0),E(Date.now()),N({title:"GPS Activado",description:"Iniciando seguimiento de velocidad y distancia."}),j.current=navigator.geolocation.watchPosition(W,V,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},L=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];f(!1),j.current&&(navigator.geolocation.clearWatch(j.current),j.current=null),O&&A&&M>0&&k>0?((0,m.W)(A,O.uid,{type:"conduccion",duration:Math.floor(k/1e3),distance:M/1e3,status:"completado"}),e&&N({title:"Sesi\xf3n Guardada",description:"Viaje de ".concat((M/1e3).toFixed(2)," km guardado en tu historial.")})):e&&N({title:"GPS Desactivado",description:"Seguimiento detenido.",variant:"destructive"}),z()};return(0,r.useEffect)(()=>{let e=null;return a&&I&&(e=setInterval(()=>{y(Date.now()-I),O&&R("explorer",1)},1e3)),()=>{e&&clearInterval(e)}},[a,I,R,O]),(0,r.useEffect)(()=>()=>{j.current&&navigator.geolocation.clearWatch(j.current)},[]),(0,s.jsxs)("div",{className:"flex flex-col min-h-dvh bg-background text-foreground",children:[(0,s.jsxs)("header",{className:"w-full p-4 border-b flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(c.P.Speedometer,{className:"h-6 w-6 text-primary"}),(0,s.jsx)("h1",{className:"text-lg sm:text-xl font-bold text-foreground",children:"Veloc\xedmetro GPS"})]}),(0,s.jsx)(o.o,{})]}),(0,s.jsxs)("main",{className:"flex-1 flex flex-col items-center justify-center w-full p-4 gap-6",children:[(0,s.jsxs)(l.Zb,{className:"w-full max-w-md text-center border-none shadow-lg bg-card/90",children:[(0,s.jsxs)(l.Ol,{children:[(0,s.jsx)(l.ll,{className:"text-xl sm:text-2xl",children:"Velocidad Actual"}),p&&(0,s.jsx)(l.SZ,{className:"text-destructive",children:p})]}),(0,s.jsx)(l.aY,{className:"flex justify-center items-center py-4",children:(0,s.jsxs)("div",{className:"relative w-48 sm:w-56 h-48 sm:h-56",children:[(0,s.jsxs)("svg",{className:"w-full h-full",viewBox:"0 0 250 250",children:[(0,s.jsx)("circle",{cx:"125",cy:"125",r:"100",className:"stroke-border",strokeWidth:"15",fill:"transparent"}),(0,s.jsx)("circle",{cx:"125",cy:"125",r:"100",className:(0,d.cn)("transition-all duration-300",a?"stroke-primary":"stroke-muted"),strokeWidth:"15",fill:"transparent",strokeDasharray:"628.32",strokeDashoffset:628.32-e/150*628.32,strokeLinecap:"round",transform:"rotate(-90 125 125)"})]}),(0,s.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,s.jsx)("span",{className:"text-5xl sm:text-7xl font-bold font-headline tracking-tighter text-primary",children:e}),(0,s.jsx)("span",{className:"text-base sm:text-lg text-muted-foreground",children:"km/h"})]})]})}),(0,s.jsxs)(l.eW,{className:"flex flex-col gap-4",children:[(0,s.jsxs)(n.z,{size:"lg",className:"w-full max-w-[200px]",onClick:()=>{a?L():C()},variant:a?"destructive":"default",children:[a?(0,s.jsx)(c.P.Pause,{className:"mr-2 h-5 w-5"}):(0,s.jsx)(c.P.Play,{className:"mr-2 h-5 w-5"}),a?"Detener":"Iniciar"]}),!O&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Inicia sesi\xf3n para guardar tus viajes"})]})]}),(0,s.jsxs)(l.Zb,{className:"w-full max-w-md",children:[(0,s.jsx)(l.Ol,{children:(0,s.jsx)(l.ll,{className:"text-lg sm:text-xl",children:"Resumen de la Sesi\xf3n Actual"})}),(0,s.jsxs)(l.aY,{className:"p-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2 p-3 bg-muted rounded-lg",children:[(0,s.jsx)(c.P.Gauge,{className:"h-6 w-6 text-primary"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Vel. M\xe1xima"}),(0,s.jsxs)("p",{className:"font-bold text-lg",children:[b," ",(0,s.jsx)("span",{className:"text-base font-normal",children:"km/h"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2 p-3 bg-muted rounded-lg",children:[(0,s.jsx)(c.P.Gauge,{className:"h-6 w-6 text-primary"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Vel. Media"}),(0,s.jsxs)("p",{className:"font-bold text-lg",children:[S," ",(0,s.jsx)("span",{className:"text-base font-normal",children:"km/h"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2 p-3 bg-muted rounded-lg",children:[(0,s.jsx)(c.P.Milestone,{className:"h-6 w-6 text-primary"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Distancia"}),(0,s.jsxs)("p",{className:"font-bold text-lg",children:[(M/1e3).toFixed(2)," ",(0,s.jsx)("span",{className:"text-base font-normal",children:"km"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2 p-3 bg-muted rounded-lg",children:[(0,s.jsx)(c.P.Timer,{className:"h-6 w-6 text-primary"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tiempo"}),(0,s.jsx)("p",{className:"font-bold text-lg",children:h(k)})]})]})]})]}),(0,s.jsx)("footer",{className:"w-full text-center p-4 border-t",children:(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"La precisi\xf3n de la velocidad depende del GPS de tu dispositivo."})})]})}},6586:function(e,t,a){"use strict";a.d(t,{W:function(){return s}}),a(3079);var s=(0,a(2119).$)("66c60dfda9d08bd4794d8eeab09fbd1dc8a50623")}},function(e){e.O(0,[4358,139,9555,6137,611,2661,248,7283,1003,1542,3635,6448,6349,1304,2971,2117,1744],function(){return e(e.s=4823)}),_N_E=e.O()}]);